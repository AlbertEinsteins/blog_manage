<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>站内搜索</title>
  <link rel="stylesheet" th:href="@{/bootstrap-3.3.7-dist/css/bootstrap.css}">
  <link rel="stylesheet" th:href="@{/layui-v2.5.4/layui/css/layui.css}">
  <link rel="stylesheet" th:href="@{/css/index.css}">
  <link rel="stylesheet" th:href="@{/css/search_top.css}">


  <script th:src="@{/js/jquery.min.js}"></script>
</head>

<body>

<div class="page">
  <!-- 顶部 -->
  <header th:replace="common_index::#header">

  </header>

  <!--搜索框-->
  <div th:replace="common_index :: #page-search"></div>


  <!-- 面包屑导航 -->
  <div class="bread-nav">
    <a th:href="@{/}">
      <i class="layui-icon layui-icon-home" style="font-size: 10px;"></i>
      首页
    </a>
    <i class="layui-icon layui-icon-right" style="font-size: 10px;"></i>
    <a href="" th:href="@{/search_top/{id}(id=${sort.sortId})}">[[${sort.sortName}]]</a>
    <i class="layui-icon layui-icon-right" style="font-size: 10px;"></i>
    文章
  </div>

  <!-- 显示菜单 -->
  <div class="menu-bar">
    <ul>
      <li th:each="sort : ${sonList}">
        <a th:href="@{/search_top/{id}(id=${sort.sortId})}">[[ ${sort.sortName} ]]</a></li>
    </ul>
  </div>

  <!-- 主体 -->
  <div class="page-main">
    <div class="left">

      <div id="articleContent" th:class="content" class="content">


      </div>

      <!--分页-->
      <div id="test1"></div>

      <div class="clear"></div>

    </div>

    <!-- 右侧 -->
    <div id="aside" class="right">
      <aside class="about-1">
        <div class="top">
          <div class="title-icon">
            <span class="glyphicon glyphicon-align-justify title-center"></span>
          </div>
          <div class="title-text">站内搜索</div>
        </div>
        <div class="main">
          <div class="wrapper">
            <form id="searchF" action="./search.html" method="post">
              <div class="input-group">
                <input type="text" name="" required class="form-control" aria-describedby="basic-submit">
                <span style="cursor: pointer;background-color: #009688; color: #fff;" class="input-group-addon"
                      id="basicSubmit">搜索</span>
                <script>
                  $(function () {
                    $("#basicSubmit").click(function () {
                      if (check()) {
                        $("#searchF").submit();
                      } else {
                        layui.use('layer', function () {
                          var layer = layui.layer;

                          layer.msg("输入不能为空");
                        });
                      }
                    });

                    function check() {
                      return !$("#searchF input").val() == '';
                    }
                  })
                </script>
              </div>
            </form>
          </div>
        </div>
      </aside>


      <aside class="about-3">
        <div class="top">
          <div class="title-icon">
            <span class="glyphicon glyphicon-align-justify title-center"></span>
          </div>
          <div class="title-text">
            热评文章
          </div>
        </div>
        <div class="main">
          <ul>
            <li><span class="label label-danger">1</span><a href="">Spring Boot</a>
            </li>
            <li><span class="label label-danger">2</span><a href="">Vue</a>
            </li>
            <li><span class="label label-danger">3</span><a href="">Springboot 实现用户登录等等的的功能阿萨德 阿萨德</a>
            </li>
            <li><span class="label label-warning">4</span><a href="">五子棋</a>
            </li>
            <li><span class="label label-warning">5</span><a href="">MacType仿mac字体</a>
            </li>
            <li><span class="label label-default">6</span><a href="">Docker</a>
            </li>
            <li><span class="label label-default">7</span><a href="">Linux赋予一个用户root权限</a>
            </li>
            <li><span class="label label-default">8</span><a href="">Spring Securit</a>
            </li>
            <li><span class="label label-default">9</span><a href="">Spring Securit</a>
            </li>
            <li><span class="label label-default">10</span><a href="">Spring Securit</a>
            </li>
          </ul>
        </div>
      </aside>

      <aside class="about-3">
        <div class="top">
          <div class="title-icon">
            <span class="glyphicon glyphicon-align-justify title-center"></span>
          </div>
          <div class="title-text">
            随机文章
          </div>
        </div>
        <div class="main">
          <ul>
            <li><a href="">Spring Boot</a></li>
            <li><a href="">Vue</a></li>
            <li><a href="">Springboot 实现用户登录等等的的功能阿萨德 阿萨德</a></li>
            <li><a href="">五子棋</a></li>
            <li><a href="">MacType仿mac字体</a></li>
            <li><a href="">Docker</a></li>
            <li><a href="">Linux赋予一个用户root权限</a></li>
          </ul>
        </div>
      </aside>

      <aside class="about-4">
        <div class="top">
          <div class="title-icon">
            <span class="glyphicon glyphicon-align-justify title-center"></span>
          </div>
          <div class="title-text">
            分类
          </div>
        </div>
        <div class="main">
          <a class="layui-btn layui-btn-primary layui-btn-sm" href="">Hibernate</a>
          <a class="layui-btn layui-btn-primary layui-btn-sm" href="">Hibernate</a>
          <a class="layui-btn layui-btn-normal layui-btn-sm" href="">Hibernate</a>
          <a class="layui-btn layui-btn-primary layui-btn-sm" href="">Hibernate</a>
          <a class="layui-btn layui-btn-primary layui-btn-sm" href="">Hibernate</a>
          <a class="layui-btn layui-btn-primary layui-btn-sm" href="">Redis</a>
          <a class="layui-btn layui-btn-danger layui-btn-sm" href="">Redis</a>
          <a class="layui-btn layui-btn-primary layui-btn-sm" href="">Redis</a>
          <a class="layui-btn layui-btn-warm layui-btn-sm" href="">Redis</a>
          <a class="layui-btn layui-btn-radius layui-btn-sm" href="">Redis</a>
          <a class="layui-btn layui-btn-radius layui-btn-sm" href="">Redis</a>
        </div>
      </aside>


      <aside class="about-5">
        <div class="top">
          <div class="title-icon">
            <span class="glyphicon glyphicon-align-justify title-center"></span>
          </div>
          <div class="title-text">
            近期评论
          </div>
        </div>
        <div class="main">
          <ul>
            <li><a href=""><span class="glyphicon glyphicon-user"></span><strong>用户A</strong>博主，不太对真的，It's really true
              123 123213</a></li>
            <li><a href=""><span class="glyphicon glyphicon-user"></span><strong>用户A</strong>博主，不太对</a></li>
            <li><a href=""><span class="glyphicon glyphicon-user"></span><strong>用户A</strong>博主，不太对</a></li>
            <li><a href=""><span class="glyphicon glyphicon-user"></span><strong>用户A</strong>博主，不太对</a></li>
            <li><a href=""><span class="glyphicon glyphicon-user"></span><strong>用户A</strong>博主，不太对</a></li>
            <li><a href=""><span class="glyphicon glyphicon-user"></span><strong>用户A</strong>博主，不太对</a></li>
            <li><a href=""><span class="glyphicon glyphicon-user"></span><strong>用户A</strong>博主，不太对</a></li>
            <li><a href=""><span class="glyphicon glyphicon-user"></span><strong>用户A</strong>博主，不太对</a></li>
            <li><a href=""><span class="glyphicon glyphicon-user"></span><strong>用户A</strong>博主，不太对</a></li>
            <li><a href=""><span class="glyphicon glyphicon-user"></span><strong>用户A</strong>博主，不太对</a></li>
            <li><a href=""><span class="glyphicon glyphicon-user"></span><strong>用户A</strong>博主，不太对</a></li>
          </ul>
        </div>
      </aside>
    </div>


  </div>

  <div th:class="clear"></div>
  <div th:replace="common_index::#footer"></div>

  <div th:replace="common_index::#script-import"></div>
</div>

<script>
  const sid = [[ ${sort.sortId}]];
  function toMyDateString(date) {
    var dt = new Date(date) ;

    const year = dt.getFullYear() ;
    const month = dt.getMonth() + 1;
    const day = dt.getDate();
    const hour = dt.getHours();
    const min = dt.getMinutes();

    return `${year}-${month}-${day} ${hour}:${min}`;
  };

  $(function () {


    layui.use('laypage', () => {

      const laypage = layui.laypage;

      laypage.render({
        elem: 'test1',
        count: [[ ${total}]],
        limit: 10,
        limits: [10, 15, 20],
        jump(obj, first) {
          // console.log(obj);

          $.get(context + `getPagableArticle?sid=${sid}&pagenum=${obj.curr}&pagesize=${obj.limit}`, (result) => {

            const data = result.data.data;
            obj.limit = result.data.pagesize;


            $('#articleContent').html('');
            $.each(data, (idx, item) => {
              const date = new Date(item.publishTime) ;
              // console.log(date);
              // console.log(item.tagIds) ;


              const defaultUrl = item.imgUrl ? item.imgUrl : 'http://file.mtchome.com/p/2014/12-16/7012d73ff9b73b117b12a30bbe7e718c.jpg';

              const artcle = `
                <article>
                  <figure class="blog-img">
                    <a href="${context}lookup/${item.articleId}"><img src="${defaultUrl}" alt=""></a>
                    <span><a href="" class="layui-btn layui-btn-danger layui-btn-sm"
                      style="text-decoration: none;">SpringBoot</a></span>
                  </figure>
                  <header class="blog-title">
                    <h2><a href="${context}lookup/${item.articleId}">${item.title}</a></h2>
                  </header>
                  <div class="blog-desc">
                  ${item.html}
                  </div>
                  <div class="blog-open">
                    <span class="list-border">${toMyDateString(date)}</span>
                    <span class="glyphicon glyphicon-eye-open"></span> ${item.lookupNum} views
                    <span class="list-border"></span>
                    <a href="${context}lookup/${item.articleId}"><span class="glyphicon glyphicon-comment" style="margin-top: 4px;"></span> 发表评论</a>
                    <a href="${context}lookup/${item.articleId}" class="layui-btn btn-success layui-btn-sm open">阅读全文</a>
                  </div>
                </article>
                `;

              $('#articleContent').append(artcle);
              // console.log(item);

            });
          });
        },
        layout: ['prev', 'page', 'next', 'limit', 'count']
      });
    });
  });
</script>
</body>

</html>